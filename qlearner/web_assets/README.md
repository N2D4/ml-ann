Slightly modified in 2019 to run in the web browser
